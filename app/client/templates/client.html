{% extends 'base.html' %}
{% load static %}

{% block title %} Clientes {% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'css/cliente.css' %}">
{% endblock %}

{% block main %}


<div class="container" id="container_page">
        <!-- Modal -->
        <div class="modal fade" id="modal_client" tabindex="-1" aria-labelledby="modal_clientLabel" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered" style="color:black;">
            <div class="modal-content">
              <div class="modal-header">
                <h1 class="modal-title fs-5" id="title_modal">Dados do Cliente</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">

              </div>
              <div class="modal-footer">

                   <button onclick="delete_client('1')" type="button"
                           class="btn btn-danger" id="button_action">
                        Deletar
                    </button>
                   <button id="button_close" type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                       Fechar
                   </button>

              </div>
            </div>
          </div>
        </div>

        <h3 class="header_text">Listagem de Clientes</h3>
        <br>

        <ul class="nav" STYLE="padding: 10px 0px 1px 0px;">
          <li class="nav-item">
                <button type="button" class="btn btn-primary " style="color: white;"
                      onclick="view_create_client()"
                      data-bs-toggle="modal" data-bs-target="#modal_client">
                    <i class="fa-solid fa-plus"></i> NOVO CLIENTE
                </button>
          </li>
        </ul>
        <br>
              <div class="row row-cols-lg-auto g-3 align-items-center">
              <div class="col-sm-12">
                <div class="input-group">
                    <input type="text" name="name_client" class="form-control"
                           placeholder="Nome do Cliente" id="id_query">
                    <button type="button" class="btn btn-primary" onclick="update_list_client()"> Buscar </button>

                </div>
              </div>

            </div><br>

            <div id="list_clients">
                <div class="table-responsive">
                <table class="table table-hover">
                  <thead id="head_column_table">
                    <tr>
                      <th scope="col">ID</th>
                      <th scope="col">Nome completo</th>
                      <th scope="col">Ações</th>
                    </tr>
                  </thead>
                    <tbody id="line_table">
                      {% for cliente in clientes %}

                        <tr id="client-{{ cliente.id }}"  style="cursor: pointer;">
                          <td scope="row" >{{ cliente.id }}</td>
                          <td><a>{{ cliente.full_name|upper }}</a></td>
                          <td>
                              <button type="button" class="btn btn-primary openBtn"
                                     onclick="view_client({{ cliente.id }})"
                                      data-bs-toggle="modal" data-bs-target="#modal_client">
                                    <i class="fa-solid fa-eye"></i>
                            </button>

                              <button type="button" class="btn btn-danger openBtn"
                                      onclick="view_delete_client({{ cliente.id }},'{{ cliente.full_name }}')"
                                      data-bs-toggle="modal" data-bs-target="#modal_client">
                                    <i class="fa fa-trash" aria-hidden="true"></i>
                               </button>
                              <button type="button" class="btn btn-warning openBtn"
                                      style="color: white;background-color:#ff9307;"
                                      onclick="view_update_client({{ cliente.id }},'{{ cliente.full_name }}')"
                                      data-bs-toggle="modal" data-bs-target="#modal_client">

                                    <i class="fa-solid fa-pen-to-square"></i>
                               </button>
                          </td>

                        </tr>

                      {% empty %}
                        <li>Não existem clientes cadastrados</li>
                      {% endfor %}
                  </tbody>
                </table>
                </div>

                 <nav aria-label="...">
                    <ul class="pagination">
                      <input type="hidden" id="id_page_itens" name="page_itens" value="{{page_obj.object_list|length}}">
                       <input type="hidden" id="id_page_index" name="page_index" value="{{ page_obj.number }}">
                      {% if page_obj.has_previous %}
                    <li class="page-item">
                        <button type="button" class="page-link" onclick="update_list_client({{page_obj.previous_page_number}})">
                            Anterior
                        </button>
                    </li>
                      {% else %}
                      <li class="page-item disabled">
                          <a class="page-link" href="#">Previous</a>
                      </li>
                       {% endif %}

                    {% for num_page in  page_obj.paginator.page_range %}
                      {% if page_obj.number == num_page %}
                        <li class="page-item active">
                          <span class="page-link">
                            {{ num_page }}
                            <span class="sr-only">(current)</span>
                          </span>
                        </li>
                      {% else %}
                        <li class="page-item">
                            <button type="button" class="page-link" onclick="update_list_client({{ num_page }})"> {{ num_page }} </button>
                        </li>
                      {% endif %}

                    {% endfor %}

                    {% if page_obj.has_next %}
                        <li class="page-item">
                           <button type="button" class="page-link" onclick="update_list_client({{ page_obj.next_page_number }})">
                               Next
                           </button>

                        </li>
                    {% else %}
                        <li class="page-item disabled">
                          <a class="page-link"  href="#">Next</a>
                        </li>
                    {% endif%}
                    </ul>
                    </nav>
            </div>
        <br>
    </div>


{% endblock %}

{% block staticfiles %}
    <script src="{% static 'js/client.js' %}"></script>
{% endblock %}